<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FakeZone - Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: #0a0a0a;
            font-family: 'Segoe UI', sans-serif;
            color: #fff;
            display: flex;
        }

        .sidebar {
            width: 250px;
            background: #000;
            border-right: 1px solid #1a1a1a;
            padding: 20px;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 40px;
            background: linear-gradient(45deg, #fff, #ff3333);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
            padding: 10px 0;
        }

        .menu-section {
            margin-bottom: 10px;
        }

        .menu-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 15px;
            background: #111;
            border: 1px solid #222;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .menu-header:hover {
            border-color: #ff3333;
            background: #151515;
        }

        .menu-header.active {
            border-color: #ff3333;
            background: rgba(255,51,51,0.05);
        }

        .menu-title {
            font-size: 14px;
            font-weight: 600;
            color: #fff;
        }

        .menu-arrow {
            transition: transform 0.3s;
            color: #666;
            font-size: 12px;
        }

        .menu-header.active .menu-arrow {
            transform: rotate(180deg);
            color: #ff3333;
        }

        .menu-dropdown {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .menu-dropdown.active {
            max-height: 300px;
        }

        .menu-link {
            display: block;
            padding: 12px 15px 12px 45px;
            color: #888;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.3s;
            border-left: 2px solid transparent;
            margin-left: 15px;
        }

        .menu-link:hover {
            color: #fff;
            background: rgba(255,255,255,0.02);
        }

        .menu-link.active {
            color: #ff3333;
            border-left-color: #ff3333;
            background: rgba(255,51,51,0.05);
        }

        .main-content {
            margin-left: 250px;
            flex: 1;
            padding: 30px;
            min-height: 100vh;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #1a1a1a;
        }

        .page-title {
            font-size: 24px;
            color: #fff;
        }

        .page-subtitle {
            color: #666;
            font-size: 14px;
            margin-top: 5px;
        }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 10px 20px;
            background: #1a1a1a;
            border: 1px solid #333;
            color: #fff;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .btn:hover {
            border-color: #ff3333;
            background: rgba(255,51,51,0.05);
        }

        .btn-primary {
            background: linear-gradient(135deg, #ff3333, #cc0000);
            border: none;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(255,51,51,0.4);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 13px;
        }

        .logout-btn {
            border-color: #ff3333;
            color: #ff3333;
        }

        .page-view {
            display: none;
        }

        .page-view.active {
            display: block;
        }

        .section-title {
            font-size: 14px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
            margin-top: 30px;
        }

        .section-title:first-child {
            margin-top: 0;
        }

        .tile-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .tile-grid-2 {
            grid-template-columns: repeat(2, 1fr);
        }

        .tile {
            background: #111;
            border: 1px solid #1a1a1a;
            border-radius: 10px;
            overflow: hidden;
        }

        .tile-header {
            background: #0a0a0a;
            padding: 12px 15px;
            border-bottom: 1px solid #1a1a1a;
            font-size: 13px;
            color: #ff3333;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .tile-content {
            padding: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group:last-child {
            margin-bottom: 0;
        }

        .form-group label {
            display: block;
            font-size: 11px;
            color: #666;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            background: #0a0a0a;
            border: 1px solid #222;
            border-radius: 6px;
            color: #fff;
            font-size: 14px;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #ff3333;
        }

        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .form-group select {
            cursor: pointer;
        }

        .form-group select option {
            background: #0a0a0a;
            color: #fff;
        }

        .toggle-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #1a1a1a;
        }

        .toggle-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .toggle-item:first-child {
            padding-top: 0;
        }

        .toggle-label {
            font-size: 13px;
            color: #fff;
        }

        .toggle-switch {
            position: relative;
            width: 44px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #222;
            border-radius: 24px;
            transition: 0.3s;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: #666;
            border-radius: 50%;
            transition: 0.3s;
        }

        .toggle-switch input:checked + .toggle-slider {
            background-color: rgba(255,51,51,0.3);
        }

        .toggle-switch input:checked + .toggle-slider:before {
            transform: translateX(20px);
            background-color: #ff3333;
        }

        .color-picker-wrapper {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .color-picker {
            width: 45px;
            height: 45px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            background: transparent;
            padding: 0;
        }

        .color-picker::-webkit-color-swatch-wrapper {
            padding: 0;
        }

        .color-picker::-webkit-color-swatch {
            border-radius: 6px;
            border: 2px solid #333;
        }

        .color-hex {
            flex: 1;
            font-family: monospace;
        }

        .range-wrapper {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .range-slider {
            flex: 1;
            -webkit-appearance: none;
            height: 6px;
            background: #222;
            border-radius: 3px;
            outline: none;
        }

        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: #ff3333;
            border-radius: 50%;
            cursor: pointer;
        }

        .range-value {
            min-width: 45px;
            text-align: center;
            font-size: 13px;
            color: #fff;
            background: #1a1a1a;
            padding: 5px 10px;
            border-radius: 4px;
        }

        .effect-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .effect-option {
            padding: 12px 8px;
            background: #0a0a0a;
            border: 2px solid #222;
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .effect-option:hover {
            border-color: #444;
        }

        .effect-option.active {
            border-color: #ff3333;
            background: rgba(255,51,51,0.05);
        }

        .effect-name {
            font-size: 11px;
            color: #888;
            margin-top: 5px;
        }

        .effect-preview {
            font-size: 16px;
            font-weight: bold;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .effect-none { color: #fff; }
        
        .effect-glitch {
            color: #fff;
            animation: glitchPreview 0.5s infinite;
        }
        
        @keyframes glitchPreview {
            0%, 100% { text-shadow: 2px 0 #ff0000, -2px 0 #00ffff; }
            50% { text-shadow: -2px 0 #ff0000, 2px 0 #00ffff; }
        }
        
        .effect-rainbow {
            background: linear-gradient(90deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #8b00ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-size: 200% 100%;
            animation: rainbowShift 2s linear infinite;
        }
        
        @keyframes rainbowShift {
            0% { background-position: 0% 50%; }
            100% { background-position: 200% 50%; }
        }
        
        .effect-glow {
            color: #fff;
            text-shadow: 0 0 10px #ff3333, 0 0 20px #ff3333;
        }
        
        .effect-wave {
            color: #fff;
            animation: wavePreview 1s ease-in-out infinite;
        }
        
        @keyframes wavePreview {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }

        .effect-typing {
            color: #fff;
            border-right: 2px solid #fff;
            animation: typingCursor 0.7s step-end infinite;
        }

        @keyframes typingCursor {
            50% { border-color: transparent; }
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }

        .info-card {
            background: #111;
            border: 1px solid #1a1a1a;
            border-radius: 10px;
            padding: 20px;
        }

        .info-card-label {
            font-size: 11px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }

        .info-card-value {
            font-size: 16px;
            color: #fff;
            font-weight: 500;
            word-break: break-all;
        }

        .info-card-value a {
            color: #ff3333;
            text-decoration: none;
        }

        .settings-section {
            background: #111;
            border: 1px solid #1a1a1a;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .settings-section h3 {
            font-size: 14px;
            color: #fff;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #222;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .setting-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid #1a1a1a;
        }

        .setting-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .setting-info {
            flex: 1;
        }

        .setting-label {
            font-size: 14px;
            color: #fff;
            margin-bottom: 4px;
        }

        .setting-value {
            font-size: 13px;
            color: #666;
        }

        .setting-action {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .edit-input {
            padding: 8px 12px;
            background: #0a0a0a;
            border: 1px solid #333;
            border-radius: 4px;
            color: #fff;
            font-size: 13px;
            width: 180px;
        }

        .edit-input:focus {
            outline: none;
            border-color: #ff3333;
        }

        .edit-buttons {
            display: flex;
            gap: 8px;
        }

        .btn-save {
            padding: 6px 12px;
            background: #ff3333;
            border: none;
            color: #fff;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .btn-cancel {
            padding: 6px 12px;
            background: transparent;
            border: 1px solid #666;
            color: #666;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .preview-wrapper {
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .preview-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            z-index: 0;
        }

        .preview-bg-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1;
        }

        .preview-box {
            background: #111;
            border: 1px solid #1a1a1a;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            position: relative;
            z-index: 2;
        }

        .preview-box.has-bg {
            background: transparent;
            border: none;
        }

        .preview-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            border: 3px solid #ff3333;
            margin-bottom: 15px;
            object-fit: cover;
        }

        .preview-name {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .preview-bio {
            color: #888;
            font-size: 14px;
            max-width: 400px;
            margin: 0 auto;
        }

        .status-success {
            color: #00ff00;
            font-size: 13px;
            margin-top: 5px;
        }

        .status-error {
            color: #ff3333;
            font-size: 13px;
            margin-top: 5px;
        }

        .hidden {
            display: none !important;
        }

        .save-section {
            margin-top: 20px;
        }

        .audio-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }

        .btn-audio {
            padding: 8px 16px;
            background: #1a1a1a;
            border: 1px solid #333;
            color: #fff;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s;
        }

        .btn-audio:hover {
            border-color: #ff3333;
        }

        .btn-audio.playing {
            background: rgba(255,51,51,0.2);
            border-color: #ff3333;
        }

        .audio-status {
            font-size: 11px;
            color: #666;
        }

        .audio-status.playing {
            color: #00ff00;
        }

        .audio-info {
            font-size: 11px;
            color: #666;
            margin-top: 8px;
        }

        .link-input-wrapper {
            position: relative;
        }

        .link-input-wrapper svg {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            width: 18px;
            height: 18px;
            fill: #666;
            pointer-events: none;
        }

        .link-input-wrapper input {
            padding-left: 40px;
        }

        @media (max-width: 1200px) {
            .tile-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .info-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 900px) {
            .tile-grid {
                grid-template-columns: 1fr;
            }
            .effect-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 220px;
            }
            .main-content {
                margin-left: 220px;
            }
            .info-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Poppins:wght@400;600&family=Montserrat:wght@400;600&family=Open+Sans:wght@400;600&family=Lato:wght@400;700&family=Oswald:wght@400;600&family=Playfair+Display:wght@400;700&family=Ubuntu:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="logo">FakeZone</div>
        
        <div class="menu-section">
            <div class="menu-header active" onclick="toggleMenu('account')">
                <span class="menu-title">Account</span>
                <span class="menu-arrow">▼</span>
            </div>
            <div class="menu-dropdown active" id="account-dropdown">
                <a href="#" class="menu-link active" onclick="showPage('overview', this)">Overview</a>
                <a href="#" class="menu-link" onclick="showPage('settings', this)">Settings</a>
            </div>
        </div>

        <div class="menu-section">
            <div class="menu-header" onclick="toggleMenu('profile')">
                <span class="menu-title">Profile</span>
                <span class="menu-arrow">▼</span>
            </div>
            <div class="menu-dropdown" id="profile-dropdown">
                <a href="#" class="menu-link" onclick="showPage('customize', this)">Customize</a>
                <a href="#" class="menu-link" onclick="showPage('links', this)">Links</a>
                <a href="#" class="menu-link" onclick="viewProfile()">View Profile</a>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        
        <!-- OVERVIEW PAGE -->
        <div class="page-view active" id="page-overview">
            <div class="page-header">
                <div>
                    <h1 class="page-title">Overview</h1>
                    <p class="page-subtitle">Welcome to FakeZone dashboard</p>
                </div>
                <div class="header-actions">
                    <button class="btn logout-btn" onclick="logout()">Logout</button>
                </div>
            </div>

            <div class="info-grid">
                <div class="info-card">
                    <div class="info-card-label">Username</div>
                    <div class="info-card-value" id="overview-username">-</div>
                </div>
                <div class="info-card">
                    <div class="info-card-label">Email</div>
                    <div class="info-card-value" id="overview-email">-</div>
                </div>
                <div class="info-card">
                    <div class="info-card-label">Profile</div>
                    <div class="info-card-value">
                        <a href="#" id="overview-profile-url" target="_blank">-</a>
                    </div>
                </div>
                <div class="info-card">
                    <div class="info-card-label">UID</div>
                    <div class="info-card-value" id="overview-uid">-</div>
                </div>
            </div>
        </div>

        <!-- SETTINGS PAGE -->
        <div class="page-view" id="page-settings">
            <div class="page-header">
                <div>
                    <h1 class="page-title">Settings</h1>
                    <p class="page-subtitle">Manage your account</p>
                </div>
                <div class="header-actions">
                    <button class="btn logout-btn" onclick="logout()">Logout</button>
                </div>
            </div>

            <div class="settings-section">
                <h3>Account Information</h3>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Username</div>
                        <div class="setting-value" id="settings-username-display">-</div>
                        <div id="username-status"></div>
                    </div>
                    <div class="setting-action" id="username-view-mode">
                        <button class="btn btn-small" onclick="startEditUsername()">Change</button>
                    </div>
                    <div class="setting-action hidden" id="username-edit-mode">
                        <input type="text" class="edit-input" id="new-username">
                        <div class="edit-buttons">
                            <button class="btn-save" onclick="saveUsername()">Save</button>
                            <button class="btn-cancel" onclick="cancelEditUsername()">Cancel</button>
                        </div>
                    </div>
                </div>

                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Display Name</div>
                        <div class="setting-value" id="settings-displayname-display">-</div>
                        <div id="displayname-status"></div>
                    </div>
                    <div class="setting-action" id="displayname-view-mode">
                        <button class="btn btn-small" onclick="startEditDisplayName()">Change</button>
                    </div>
                    <div class="setting-action hidden" id="displayname-edit-mode">
                        <input type="text" class="edit-input" id="new-displayname">
                        <div class="edit-buttons">
                            <button class="btn-save" onclick="saveDisplayName()">Save</button>
                            <button class="btn-cancel" onclick="cancelEditDisplayName()">Cancel</button>
                        </div>
                    </div>
                </div>

                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Email</div>
                        <div class="setting-value" id="settings-email">-</div>
                    </div>
                    <div class="setting-action">
                        <button class="btn btn-small" onclick="alert('Coming soon')">Change</button>
                    </div>
                </div>

                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Password</div>
                        <div class="setting-value">••••••••</div>
                    </div>
                    <div class="setting-action">
                        <button class="btn btn-small" onclick="alert('Coming soon')">Change</button>
                    </div>
                </div>
            </div>

            <div class="settings-section">
                <h3>Connected Accounts</h3>
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Discord</div>
                        <div class="setting-value" id="settings-discord">Not connected</div>
                    </div>
                    <div class="setting-action">
                        <button class="btn btn-small" id="settings-discord-btn" onclick="connectDiscord()">Connect</button>
                    </div>
                </div>
            </div>

            <div class="settings-section" style="border-color: #ff3333;">
                <h3 style="color: #ff3333;">Danger Zone</h3>
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Delete Account</div>
                        <div class="setting-value">Permanently delete your account and data</div>
                    </div>
                    <div class="setting-action">
                        <button class="btn btn-small" style="border-color:#ff3333; color:#ff3333;">Delete</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- CUSTOMIZE PAGE -->
        <div class="page-view" id="page-customize">
            <div class="page-header">
                <div>
                    <h1 class="page-title">Customize</h1>
                    <p class="page-subtitle">Customize your profile appearance</p>
                </div>
                <div class="header-actions">
                    <button class="btn" onclick="viewProfile()">View Profile</button>
                    <button class="btn logout-btn" onclick="logout()">Logout</button>
                </div>
            </div>

            <!-- Assets Uploader -->
            <div class="section-title">Assets Uploader</div>
            <div class="tile-grid">
                <div class="tile">
                    <div class="tile-header">Background</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Background Image URL</label>
                            <input type="url" id="bg-image" placeholder="https://example.com/bg.jpg" oninput="updatePreview()">
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">Audio</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Music URL</label>
                            <input type="url" id="bg-audio" placeholder="YouTube or MP3 URL" oninput="validateAudioURL(this.value)">
                            <div class="audio-info">Supports: YouTube, MP3, WAV, OGG</div>
                        </div>
                        <div class="form-group">
                            <label>Volume</label>
                            <div class="range-wrapper">
                                <input type="range" class="range-slider" id="audio-volume" min="0" max="100" value="50" oninput="updateVolumeLabel()">
                                <span class="range-value" id="audio-volume-label">50%</span>
                            </div>
                        </div>
                        <div class="audio-controls">
                            <button class="btn-audio" id="audio-test-btn" onclick="toggleTestAudio()">
                                <span id="audio-test-text">▶ Test Audio</span>
                            </button>
                            <span class="audio-status" id="audio-status"></span>
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">Profile Avatar</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Avatar URL</label>
                            <input type="url" id="avatar" placeholder="https://example.com/avatar.png" oninput="updatePreview()">
                        </div>
                        <p style="font-size:11px; color:#666; margin-top:10px;">Empty = Discord avatar</p>
                    </div>
                </div>
            </div>

            <!-- General Customization -->
            <div class="section-title">General Customization</div>
            <div class="tile-grid">
                <div class="tile">
                    <div class="tile-header">Bio</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Content</label>
                            <textarea id="bio" placeholder="Write something about yourself..." oninput="updatePreview()"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Font</label>
                            <select id="bio-font" onchange="updatePreview()">
                                <option value="Segoe UI">Segoe UI</option>
                                <option value="Roboto">Roboto</option>
                                <option value="Poppins">Poppins</option>
                                <option value="Montserrat">Montserrat</option>
                                <option value="Open Sans">Open Sans</option>
                                <option value="Lato">Lato</option>
                                <option value="Oswald">Oswald</option>
                                <option value="Playfair Display">Playfair Display</option>
                                <option value="Ubuntu">Ubuntu</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Color</label>
                            <div class="color-picker-wrapper">
                                <input type="color" class="color-picker" id="bio-color" value="#888888" oninput="updateBioColorHex(); updatePreview();">
                                <input type="text" class="edit-input color-hex" id="bio-color-hex" value="#888888" oninput="updateBioColorPicker(); updatePreview();">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">Username</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Effect</label>
                            <div class="effect-grid">
                                <div class="effect-option active" data-effect="none" onclick="selectEffect('none')">
                                    <div class="effect-preview effect-none">Aa</div>
                                    <div class="effect-name">None</div>
                                </div>
                                <div class="effect-option" data-effect="glitch" onclick="selectEffect('glitch')">
                                    <div class="effect-preview effect-glitch">Aa</div>
                                    <div class="effect-name">Glitch</div>
                                </div>
                                <div class="effect-option" data-effect="rainbow" onclick="selectEffect('rainbow')">
                                    <div class="effect-preview effect-rainbow">Aa</div>
                                    <div class="effect-name">Rainbow</div>
                                </div>
                                <div class="effect-option" data-effect="glow" onclick="selectEffect('glow')">
                                    <div class="effect-preview effect-glow">Aa</div>
                                    <div class="effect-name">Glow</div>
                                </div>
                                <div class="effect-option" data-effect="wave" onclick="selectEffect('wave')">
                                    <div class="effect-preview effect-wave">Aa</div>
                                    <div class="effect-name">Wave</div>
                                </div>
                                <div class="effect-option" data-effect="typing" onclick="selectEffect('typing')">
                                    <div class="effect-preview effect-typing">Aa</div>
                                    <div class="effect-name">Typing</div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Color</label>
                            <div class="color-picker-wrapper">
                                <input type="color" class="color-picker" id="username-color" value="#ffffff" oninput="updateUsernameColorHex(); updatePreview();">
                                <input type="text" class="edit-input color-hex" id="username-color-hex" value="#ffffff" oninput="updateUsernameColorPicker(); updatePreview();">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">Background Color</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Overlay Color</label>
                            <div class="color-picker-wrapper">
                                <input type="color" class="color-picker" id="bg-overlay-color" value="#000000" oninput="updateBgOverlayColorHex(); updatePreview();">
                                <input type="text" class="edit-input color-hex" id="bg-overlay-color-hex" value="#000000" oninput="updateBgOverlayColorPicker(); updatePreview();">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Overlay Opacity</label>
                            <div class="range-wrapper">
                                <input type="range" class="range-slider" id="bg-overlay-opacity" min="0" max="100" value="60" oninput="updateBgOverlayOpacityLabel(); updatePreview();">
                                <span class="range-value" id="bg-overlay-opacity-label">60%</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">Icons Color</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Social Icons Color</label>
                            <div class="color-picker-wrapper">
                                <input type="color" class="color-picker" id="icons-color" value="#ffffff" oninput="updateIconsColorHex();">
                                <input type="text" class="edit-input color-hex" id="icons-color-hex" value="#ffffff" oninput="updateIconsColorPicker();">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Icons Style</label>
                            <select id="icons-style">
                                <option value="default">Default (Platform Colors)</option>
                                <option value="custom">Custom Color</option>
                                <option value="monochrome">Monochrome</option>
                            </select>
                        </div>
                        <p style="font-size:11px; color:#666; margin-top:10px;">Custom color will override platform-specific colors on hover</p>
                    </div>
                </div>
            </div>

            <!-- Profile Effects -->
            <div class="section-title">Profile Effects</div>
            <div class="tile-grid tile-grid-2">
                <div class="tile">
                    <div class="tile-header">Profile Opacity</div>
                    <div class="tile-content">
                        <div class="range-wrapper">
                            <input type="range" class="range-slider" id="profile-opacity" min="0" max="100" value="100" oninput="updateOpacityLabel(); updatePreview();">
                            <span class="range-value" id="profile-opacity-label">100%</span>
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">Profile Blur</div>
                    <div class="tile-content">
                        <div class="range-wrapper">
                            <input type="range" class="range-slider" id="profile-blur" min="0" max="100" value="0" oninput="updateBlurLabel(); updatePreview();">
                            <span class="range-value" id="profile-blur-label">0%</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Other Customization -->
            <div class="section-title">Other Customization</div>
            <div class="tile-grid">
                <div class="tile">
                    <div class="tile-header">Discord Avatar</div>
                    <div class="tile-content">
                        <div class="toggle-item">
                            <span class="toggle-label">Use Discord avatar</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="toggle-discord-avatar" onchange="updatePreview()">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">Volume Control</div>
                    <div class="tile-content">
                        <div class="toggle-item">
                            <span class="toggle-label">Show volume control</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="toggle-volume-control" onchange="updatePreview()">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">Avatar Decoration</div>
                    <div class="tile-content">
                        <div class="toggle-item">
                            <span class="toggle-label">Show Discord decoration</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="toggle-avatar-decoration" onchange="updatePreview()">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Preview -->
            <div class="section-title">Preview</div>
            <div class="preview-wrapper">
                <div class="preview-bg" id="preview-bg"></div>
                <div class="preview-bg-overlay" id="preview-bg-overlay" style="display:none;"></div>
                <div class="preview-box" id="preview-container">
                    <img id="previewAvatar" class="preview-avatar" src="https://via.placeholder.com/100">
                    <div id="previewUsername" class="preview-name">@username</div>
                    <div id="previewBio" class="preview-bio">Your bio here...</div>
                </div>
            </div>

            <!-- Save -->
            <div class="save-section">
                <button class="btn btn-primary" onclick="saveCustomization()" style="width:100%;">Save Changes</button>
                <div id="customizeSaveStatus"></div>
            </div>
        </div>

        <!-- LINKS PAGE -->
        <div class="page-view" id="page-links">
            <div class="page-header">
                <div>
                    <h1 class="page-title">Social Links</h1>
                    <p class="page-subtitle">Manage your social media links</p>
                </div>
                <div class="header-actions">
                    <button class="btn" onclick="viewProfile()">View Profile</button>
                    <button class="btn logout-btn" onclick="logout()">Logout</button>
                </div>
            </div>

            <!-- Social Media -->
            <div class="section-title">Social Media</div>
            <div class="tile-grid tile-grid-2">
                <div class="tile">
                    <div class="tile-header">Discord</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Username or Invite Link</label>
                            <div class="link-input-wrapper">
                                <svg viewBox="0 0 127.14 96.36"><path d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/></svg>
                                <input type="text" id="link-discord" placeholder="username#0000 or discord.gg/invite">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">Instagram</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Username</label>
                            <div class="link-input-wrapper">
                                <svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>
                                <input type="text" id="link-instagram" placeholder="username">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">Twitter / X</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Username</label>
                            <div class="link-input-wrapper">
                                <svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
                                <input type="text" id="link-twitter" placeholder="username">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">TikTok</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Username</label>
                            <div class="link-input-wrapper">
                                <svg viewBox="0 0 24 24"><path d="M12.525.02c1.31-.02 2.61-.01 3.91-.02.08 1.53.63 3.09 1.75 4.17 1.12 1.11 2.7 1.62 4.24 1.79v4.03c-1.44-.05-2.89-.35-4.2-.97-.57-.26-1.1-.59-1.62-.93-.01 2.92.01 5.84-.02 8.75-.08 1.4-.54 2.79-1.35 3.94-1.31 1.92-3.58 3.17-5.91 3.21-1.43.08-2.86-.31-4.08-1.03-2.02-1.19-3.44-3.37-3.65-5.71-.02-.5-.03-1-.01-1.49.18-1.9 1.12-3.72 2.58-4.96 1.66-1.44 3.98-2.13 6.15-1.72.02 1.48-.04 2.96-.04 4.44-.99-.32-2.15-.23-3.02.37-.63.41-1.11 1.04-1.36 1.75-.21.51-.15 1.07-.14 1.61.24 1.64 1.82 3.02 3.5 2.87 1.12-.01 2.19-.66 2.77-1.61.19-.33.4-.67.41-1.06.1-1.79.06-3.57.07-5.36.01-4.03-.01-8.05.02-12.07z"/></svg>
                                <input type="text" id="link-tiktok" placeholder="@username">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">YouTube</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Channel Name or URL</label>
                            <div class="link-input-wrapper">
                                <svg viewBox="0 0 24 24"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg>
                                <input type="text" id="link-youtube" placeholder="@channel or URL">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">Twitch</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Username</label>
                            <div class="link-input-wrapper">
                                <svg viewBox="0 0 24 24"><path d="M11.571 4.714h1.715v5.143H11.57zm4.715 0H18v5.143h-1.714zM6 0L1.714 4.286v15.428h5.143V24l4.286-4.286h3.428L22.286 12V0zm14.571 11.143l-3.428 3.428h-3.429l-3 3v-3H6.857V1.714h13.714Z"/></svg>
                                <input type="text" id="link-twitch" placeholder="username">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Gaming & Other -->
            <div class="section-title">Gaming & Other</div>
            <div class="tile-grid tile-grid-2">
                <div class="tile">
                    <div class="tile-header">Spotify</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Artist or Playlist URL</label>
                            <div class="link-input-wrapper">
                                <svg viewBox="0 0 24 24"><path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"/></svg>
                                <input type="text" id="link-spotify" placeholder="Spotify URL">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">Steam</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Steam ID or Profile URL</label>
                            <div class="link-input-wrapper">
                                <svg viewBox="0 0 24 24"><path d="M11.979 0C5.678 0 .511 4.86.022 11.037l6.432 2.658c.545-.371 1.203-.59 1.912-.59.063 0 .125.004.188.006l2.861-4.142V8.91c0-2.495 2.028-4.524 4.524-4.524 2.494 0 4.524 2.031 4.524 4.527s-2.03 4.525-4.524 4.525h-.105l-4.076 2.911c0 .052.004.105.004.159 0 1.875-1.515 3.396-3.39 3.396-1.635 0-3.016-1.173-3.331-2.727L.436 15.27C1.862 20.307 6.486 24 11.979 24c6.627 0 11.999-5.373 11.999-12S18.605 0 11.979 0zM7.54 18.21l-1.473-.61c.262.543.714.999 1.314 1.25 1.297.539 2.793-.076 3.332-1.375.263-.63.264-1.319.005-1.949s-.75-1.121-1.377-1.383c-.624-.26-1.29-.249-1.878-.03l1.523.63c.956.4 1.409 1.5 1.009 2.455-.397.957-1.497 1.41-2.454 1.012H7.54zm11.415-9.303c0-1.662-1.353-3.015-3.015-3.015-1.665 0-3.015 1.353-3.015 3.015 0 1.665 1.35 3.015 3.015 3.015 1.663 0 3.015-1.35 3.015-3.015zm-5.273-.005c0-1.252 1.013-2.266 2.265-2.266 1.249 0 2.266 1.014 2.266 2.266 0 1.251-1.017 2.265-2.266 2.265-1.253 0-2.265-1.014-2.265-2.265z"/></svg>
                                <input type="text" id="link-steam" placeholder="Steam profile URL">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">GitHub</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Username</label>
                            <div class="link-input-wrapper">
                                <svg viewBox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
                                <input type="text" id="link-github" placeholder="username">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">PayPal</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>PayPal.me Link</label>
                            <div class="link-input-wrapper">
                                <svg viewBox="0 0 24 24"><path d="M7.076 21.337H2.47a.641.641 0 0 1-.633-.74L4.944.901C5.026.382 5.474 0 5.998 0h7.46c2.57 0 4.578.543 5.69 1.81 1.01 1.15 1.304 2.42 1.012 4.287-.023.143-.047.288-.077.437-.983 5.05-4.349 6.797-8.647 6.797h-2.19c-.524 0-.968.382-1.05.9l-1.12 7.106zm14.146-14.42a3.35 3.35 0 0 0-.607-.541c-.013.076-.026.175-.041.254-.93 4.778-4.005 7.201-9.138 7.201h-2.19a.563.563 0 0 0-.556.479l-1.187 7.527h-.506l-.24 1.516a.56.56 0 0 0 .554.647h3.882c.46 0 .85-.334.922-.788.06-.26.76-4.852.816-5.09a.932.932 0 0 1 .923-.788h.58c3.76 0 6.705-1.528 7.565-5.946.36-1.847.174-3.388-.777-4.471z"/></svg>
                                <input type="text" id="link-paypal" placeholder="paypal.me/username">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Custom Link -->
            <div class="section-title">Custom Link</div>
            <div class="tile-grid tile-grid-2">
                <div class="tile">
                    <div class="tile-header">Custom URL</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Link URL</label>
                            <div class="link-input-wrapper">
                                <svg viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/></svg>
                                <input type="text" id="link-custom" placeholder="https://example.com">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">Custom Link Name</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Display Name</label>
                            <input type="text" id="link-custom-name" placeholder="My Website">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Save -->
            <div class="save-section">
                <button class="btn btn-primary" onclick="saveLinks()" style="width:100%;">Save Links</button>
                <div id="linksSaveStatus"></div>
            </div>
        </div>

    </div>

    <!-- Hidden YouTube Player -->
    <div id="youtube-player" style="display:none;"></div>
    
    <!-- Hidden Audio Element -->
    <audio id="test-audio" style="display:none;"></audio>

    <!-- YouTube API -->
    <script src="https://www.youtube.com/iframe_api"></script>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, doc, getDoc, updateDoc, deleteDoc, setDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyBIjlu_2muS5ky7hTjsc5E9gV0uOwprX0o",
            authDomain: "fakezone-f3c4a.firebaseapp.com",
            projectId: "fakezone-f3c4a",
            storageBucket: "fakezone-f3c4a.firebasestorage.app",
            messagingSenderId: "795138686378",
            appId: "1:795138686378:web:5e93855a9bf8682f197fd3"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let currentUser = null;
        let userProfile = null;
        let selectedEffect = 'none';
        let youtubePlayer = null;
        let audioPlayer = null;
        let isPlaying = false;

        function formatUid(num) {
            return '#' + String(num).padStart(4, '0');
        }

        window.toggleMenu = function(menuId) {
            const dropdown = document.getElementById(menuId + '-dropdown');
            const header = dropdown.previousElementSibling;
            dropdown.classList.toggle('active');
            header.classList.toggle('active');
        };

        window.showPage = function(pageId, linkElement) {
            document.querySelectorAll('.page-view').forEach(p => p.classList.remove('active'));
            document.getElementById('page-' + pageId).classList.add('active');
            document.querySelectorAll('.menu-link').forEach(l => l.classList.remove('active'));
            if (linkElement) linkElement.classList.add('active');
        };

        function maskEmail(email) {
            if (email.length <= 5) return email;
            return email.substring(0, 5) + '*'.repeat(email.length - 5);
        }

        function extractYouTubeId(url) {
            const regex = /(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/|youtube\.com\/v\/)([^&\n?#]+)/;
            const match = url.match(regex);
            return match ? match[1] : null;
        }

        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : {r: 0, g: 0, b: 0};
        }

        window.validateAudioURL = function(url) {
            if (!url) return true;
            
            const audioExtensions = ['.mp3', '.wav', '.ogg', '.m4a', '.webm'];
            const isDirectAudio = audioExtensions.some(ext => url.toLowerCase().includes(ext));
            const isYouTube = url.includes('youtube.com') || url.includes('youtu.be');
            
            const statusEl = document.getElementById('audio-status');
            
            if (isYouTube) {
                statusEl.textContent = 'YouTube detected ✓';
                statusEl.className = 'audio-status playing';
            } else if (isDirectAudio) {
                statusEl.textContent = 'Direct audio detected ✓';
                statusEl.className = 'audio-status playing';
            } else if (url) {
                statusEl.textContent = 'Unknown format - may not work';
                statusEl.className = 'audio-status';
            } else {
                statusEl.textContent = '';
            }
            
            return true;
        };

        window.onYouTubeIframeAPIReady = function() {
            console.log('YouTube API ready');
        };

        window.toggleTestAudio = function() {
            const url = document.getElementById('bg-audio').value;
            const volume = document.getElementById('audio-volume').value;
            const btn = document.getElementById('audio-test-btn');
            const textEl = document.getElementById('audio-test-text');
            
            if (!url) {
                alert('Please enter an audio URL first');
                return;
            }
            
            if (isPlaying) {
                stopAllAudio();
                btn.classList.remove('playing');
                textEl.textContent = '▶ Test Audio';
                isPlaying = false;
            } else {
                playTestAudio(url, volume);
                btn.classList.add('playing');
                textEl.textContent = '⏸ Stop';
                isPlaying = true;
            }
        };

        function stopAllAudio() {
            if (audioPlayer) {
                audioPlayer.pause();
                audioPlayer = null;
            }
            if (youtubePlayer) {
                youtubePlayer.destroy();
                youtubePlayer = null;
            }
        }

        function playTestAudio(url, volume) {
            stopAllAudio();
            
            const videoId = extractYouTubeId(url);
            
            if (videoId) {
                youtubePlayer = new YT.Player('youtube-player', {
                    height: '0',
                    width: '0',
                    videoId: videoId,
                    playerVars: {
                        autoplay: 1,
                        loop: 1,
                        playlist: videoId
                    },
                    events: {
                        onReady: function(event) {
                            event.target.setVolume(volume);
                            event.target.playVideo();
                        },
                        onError: function(error) {
                            alert('Error loading YouTube video. Check the URL.');
                            toggleTestAudio();
                        }
                    }
                });
            } else {
                audioPlayer = document.getElementById('test-audio');
                audioPlayer.src = url;
                audioPlayer.volume = volume / 100;
                audioPlayer.loop = true;
                audioPlayer.play().catch(e => {
                    alert('Error playing audio. Check the URL or try a different format.');
                    toggleTestAudio();
                });
            }
        }

        onAuthStateChanged(auth, async (user) => {
            if (!user) {
                window.location.href = '/';
                return;
            }
            currentUser = user;
            await loadProfile();
        });

        async function loadProfile() {
            const docSnap = await getDoc(doc(db, 'users', currentUser.uid));
            if (docSnap.exists()) {
                userProfile = docSnap.data();
                const profileUrl = `${window.location.origin}/${userProfile.username}`;
                const maskedEmail = maskEmail(currentUser.email);

                document.getElementById('overview-username').textContent = userProfile.username;
                document.getElementById('overview-email').textContent = maskedEmail;
                document.getElementById('overview-profile-url').href = profileUrl;
                document.getElementById('overview-profile-url').textContent = profileUrl;
                document.getElementById('overview-uid').textContent = formatUid(userProfile.uidNumber || 1);

                document.getElementById('settings-username-display').textContent = userProfile.username;
                document.getElementById('settings-displayname-display').textContent = userProfile.displayName || userProfile.username;
                document.getElementById('settings-email').textContent = maskedEmail;

                document.getElementById('avatar').value = userProfile.avatar || '';
                document.getElementById('bio').value = userProfile.bio || '';
                document.getElementById('bg-image').value = userProfile.bgImage || '';
                document.getElementById('bg-audio').value = userProfile.bgAudio || '';
                document.getElementById('audio-volume').value = userProfile.audioVolume || 50;
                document.getElementById('bio-font').value = userProfile.bioFont || 'Segoe UI';
                document.getElementById('bio-color').value = userProfile.bioColor || '#888888';
                document.getElementById('bio-color-hex').value = userProfile.bioColor || '#888888';
                document.getElementById('username-color').value = userProfile.usernameColor || '#ffffff';
                document.getElementById('username-color-hex').value = userProfile.usernameColor || '#ffffff';
                document.getElementById('profile-opacity').value = userProfile.profileOpacity ?? 100;
                document.getElementById('profile-blur').value = userProfile.profileBlur || 0;

                // NEW: Background and Icons colors
                document.getElementById('bg-overlay-color').value = userProfile.bgOverlayColor || '#000000';
                document.getElementById('bg-overlay-color-hex').value = userProfile.bgOverlayColor || '#000000';
                document.getElementById('bg-overlay-opacity').value = userProfile.bgOverlayOpacity ?? 60;
                document.getElementById('icons-color').value = userProfile.iconsColor || '#ffffff';
                document.getElementById('icons-color-hex').value = userProfile.iconsColor || '#ffffff';
                document.getElementById('icons-style').value = userProfile.iconsStyle || 'default';

                document.getElementById('toggle-discord-avatar').checked = userProfile.useDiscordAvatar || false;
                document.getElementById('toggle-volume-control').checked = userProfile.showVolumeControl || false;
                document.getElementById('toggle-avatar-decoration').checked = userProfile.showAvatarDecoration || false;

                // Load social links
                document.getElementById('link-discord').value = userProfile.links?.discord || '';
                document.getElementById('link-instagram').value = userProfile.links?.instagram || '';
                document.getElementById('link-twitter').value = userProfile.links?.twitter || '';
                document.getElementById('link-tiktok').value = userProfile.links?.tiktok || '';
                document.getElementById('link-youtube').value = userProfile.links?.youtube || '';
                document.getElementById('link-twitch').value = userProfile.links?.twitch || '';
                document.getElementById('link-spotify').value = userProfile.links?.spotify || '';
                document.getElementById('link-steam').value = userProfile.links?.steam || '';
                document.getElementById('link-github').value = userProfile.links?.github || '';
                document.getElementById('link-paypal').value = userProfile.links?.paypal || '';
                document.getElementById('link-custom').value = userProfile.links?.custom || '';
                document.getElementById('link-custom-name').value = userProfile.links?.customName || '';

                if (userProfile.usernameEffect) {
                    selectedEffect = userProfile.usernameEffect;
                    document.querySelectorAll('.effect-option').forEach(opt => {
                        opt.classList.toggle('active', opt.dataset.effect === selectedEffect);
                    });
                }

                if (userProfile.discord) {
                    showDiscordConnected();
                }

                updateVolumeLabel();
                updateOpacityLabel();
                updateBlurLabel();
                updateBgOverlayOpacityLabel();
                updatePreview();
            }
        }

        window.updatePreview = function() {
            const useDiscordAvatar = document.getElementById('toggle-discord-avatar').checked;
            const customAvatar = document.getElementById('avatar').value;
            const bgImage = document.getElementById('bg-image').value;
            
            const previewBg = document.getElementById('preview-bg');
            const previewBgOverlay = document.getElementById('preview-bg-overlay');
            const previewContainer = document.getElementById('preview-container');
            
            if (bgImage) {
                previewBg.style.backgroundImage = `url('${bgImage}')`;
                previewBgOverlay.style.display = 'block';
                previewContainer.classList.add('has-bg');
                
                // Apply background overlay color
                const bgOverlayColor = document.getElementById('bg-overlay-color').value;
                const bgOverlayOpacity = document.getElementById('bg-overlay-opacity').value;
                const rgb = hexToRgb(bgOverlayColor);
                previewBgOverlay.style.background = `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, ${bgOverlayOpacity / 100})`;
            } else {
                previewBg.style.backgroundImage = '';
                previewBgOverlay.style.display = 'none';
                previewContainer.classList.remove('has-bg');
            }
            
            let avatar = 'https://via.placeholder.com/100';
            if (useDiscordAvatar && userProfile?.discord?.avatar) {
                avatar = userProfile.discord.avatar;
            } else if (customAvatar) {
                avatar = customAvatar;
            } else if (userProfile?.discord?.avatar) {
                avatar = userProfile.discord.avatar;
            }

            const bio = document.getElementById('bio').value || 'Your bio here...';
            const displayName = userProfile?.displayName || userProfile?.username || 'username';
            const bioFont = document.getElementById('bio-font').value;
            const bioColor = document.getElementById('bio-color').value;
            const usernameColor = document.getElementById('username-color').value;
            const opacity = document.getElementById('profile-opacity').value;
            const blur = document.getElementById('profile-blur').value;

            document.getElementById('previewAvatar').src = avatar;

            const usernameEl = document.getElementById('previewUsername');
            usernameEl.textContent = '@' + displayName;
            usernameEl.className = 'preview-name';
            usernameEl.style.color = usernameColor;
            if (selectedEffect !== 'none') {
                usernameEl.classList.add('effect-' + selectedEffect);
            }

            const bioEl = document.getElementById('previewBio');
            bioEl.textContent = bio;
            bioEl.style.color = bioColor;
            bioEl.style.fontFamily = `'${bioFont}', sans-serif`;

            previewContainer.style.opacity = opacity / 100;
            previewContainer.style.filter = `blur(${blur / 10}px)`;
        };

        window.selectEffect = function(effect) {
            selectedEffect = effect;
            document.querySelectorAll('.effect-option').forEach(opt => {
                opt.classList.toggle('active', opt.dataset.effect === effect);
            });
            updatePreview();
        };

        window.updateBioColorHex = function() {
            document.getElementById('bio-color-hex').value = document.getElementById('bio-color').value;
        };
        window.updateBioColorPicker = function() {
            const hex = document.getElementById('bio-color-hex').value;
            if (/^#[0-9A-Fa-f]{6}$/.test(hex)) {
                document.getElementById('bio-color').value = hex;
            }
        };
        window.updateUsernameColorHex = function() {
            document.getElementById('username-color-hex').value = document.getElementById('username-color').value;
        };
        window.updateUsernameColorPicker = function() {
            const hex = document.getElementById('username-color-hex').value;
            if (/^#[0-9A-Fa-f]{6}$/.test(hex)) {
                document.getElementById('username-color').value = hex;
            }
        };

        // NEW: Background overlay color functions
        window.updateBgOverlayColorHex = function() {
            document.getElementById('bg-overlay-color-hex').value = document.getElementById('bg-overlay-color').value;
        };
        window.updateBgOverlayColorPicker = function() {
            const hex = document.getElementById('bg-overlay-color-hex').value;
            if (/^#[0-9A-Fa-f]{6}$/.test(hex)) {
                document.getElementById('bg-overlay-color').value = hex;
            }
        };
        window.updateBgOverlayOpacityLabel = function() {
            document.getElementById('bg-overlay-opacity-label').textContent = document.getElementById('bg-overlay-opacity').value + '%';
        };

        // NEW: Icons color functions
        window.updateIconsColorHex = function() {
            document.getElementById('icons-color-hex').value = document.getElementById('icons-color').value;
        };
        window.updateIconsColorPicker = function() {
            const hex = document.getElementById('icons-color-hex').value;
            if (/^#[0-9A-Fa-f]{6}$/.test(hex)) {
                document.getElementById('icons-color').value = hex;
            }
        };

        window.updateVolumeLabel = function() {
            document.getElementById('audio-volume-label').textContent = document.getElementById('audio-volume').value + '%';
            
            if (audioPlayer && !audioPlayer.paused) {
                audioPlayer.volume = document.getElementById('audio-volume').value / 100;
            }
            if (youtubePlayer && youtubePlayer.setVolume) {
                youtubePlayer.setVolume(document.getElementById('audio-volume').value);
            }
        };
        window.updateOpacityLabel = function() {
            document.getElementById('profile-opacity-label').textContent = document.getElementById('profile-opacity').value + '%';
        };
        window.updateBlurLabel = function() {
            document.getElementById('profile-blur-label').textContent = document.getElementById('profile-blur').value + '%';
        };

        // ============ SAVE LINKS ============
        window.saveLinks = async function() {
            try {
                await updateDoc(doc(db, 'users', currentUser.uid), {
                    links: {
                        discord: document.getElementById('link-discord').value,
                        instagram: document.getElementById('link-instagram').value,
                        twitter: document.getElementById('link-twitter').value,
                        tiktok: document.getElementById('link-tiktok').value,
                        youtube: document.getElementById('link-youtube').value,
                        twitch: document.getElementById('link-twitch').value,
                        spotify: document.getElementById('link-spotify').value,
                        steam: document.getElementById('link-steam').value,
                        github: document.getElementById('link-github').value,
                        paypal: document.getElementById('link-paypal').value,
                        custom: document.getElementById('link-custom').value,
                        customName: document.getElementById('link-custom-name').value
                    }
                });
                
                document.getElementById('linksSaveStatus').innerHTML = '<div class="status-success">✓ Links saved successfully!</div>';
                setTimeout(() => document.getElementById('linksSaveStatus').innerHTML = '', 3000);
                
            } catch (error) {
                console.error('Error saving links:', error);
                document.getElementById('linksSaveStatus').innerHTML = '<div class="status-error">Error saving links</div>';
            }
        };

        window.saveCustomization = async function() {
            try {
                stopAllAudio();
                
                await updateDoc(doc(db, 'users', currentUser.uid), {
                    avatar: document.getElementById('avatar').value,
                    bio: document.getElementById('bio').value,
                    bgImage: document.getElementById('bg-image').value,
                    bgAudio: document.getElementById('bg-audio').value,
                    audioVolume: parseInt(document.getElementById('audio-volume').value),
                    bioFont: document.getElementById('bio-font').value,
                    bioColor: document.getElementById('bio-color').value,
                    usernameColor: document.getElementById('username-color').value,
                    usernameEffect: selectedEffect,
                    profileOpacity: parseInt(document.getElementById('profile-opacity').value),
                    profileBlur: parseInt(document.getElementById('profile-blur').value),
                    bgOverlayColor: document.getElementById('bg-overlay-color').value,
                    bgOverlayOpacity: parseInt(document.getElementById('bg-overlay-opacity').value),
                    iconsColor: document.getElementById('icons-color').value,
                    iconsStyle: document.getElementById('icons-style').value,
                    useDiscordAvatar: document.getElementById('toggle-discord-avatar').checked,
                    showVolumeControl: document.getElementById('toggle-volume-control').checked,
                    showAvatarDecoration: document.getElementById('toggle-avatar-decoration').checked
                });
                
                document.getElementById('customizeSaveStatus').innerHTML = '<div class="status-success">✓ Saved! Your profile has been updated.</div>';
                setTimeout(() => document.getElementById('customizeSaveStatus').innerHTML = '', 3000);
                
                const btn = document.getElementById('audio-test-btn');
                const textEl = document.getElementById('audio-test-text');
                btn.classList.remove('playing');
                textEl.textContent = '▶ Test Audio';
                isPlaying = false;
                
            } catch (error) {
                console.error('Error saving:', error);
                document.getElementById('customizeSaveStatus').innerHTML = '<div class="status-error">Error saving changes</div>';
            }
        };

        window.startEditUsername = function() {
            document.getElementById('username-view-mode').classList.add('hidden');
            document.getElementById('username-edit-mode').classList.remove('hidden');
            document.getElementById('new-username').value = userProfile.username;
        };

        window.cancelEditUsername = function() {
            document.getElementById('username-view-mode').classList.remove('hidden');
            document.getElementById('username-edit-mode').classList.add('hidden');
            document.getElementById('username-status').innerHTML = '';
        };

        window.saveUsername = async function() {
            const newUsername = document.getElementById('new-username').value.toLowerCase().trim();
            const oldUsername = userProfile.username;

            if (!newUsername || newUsername.length < 3) {
                document.getElementById('username-status').innerHTML = '<span class="status-error">Min. 3 characters</span>';
                return;
            }
            if (!/^[a-z0-9_]+$/.test(newUsername)) {
                document.getElementById('username-status').innerHTML = '<span class="status-error">Only a-z, 0-9, _</span>';
                return;
            }
            if (newUsername === oldUsername) {
                cancelEditUsername();
                return;
            }

            try {
                const exists = await getDoc(doc(db, 'usernames', newUsername));
                if (exists.exists()) {
                    document.getElementById('username-status').innerHTML = '<span class="status-error">Already taken</span>';
                    return;
                }

                await deleteDoc(doc(db, 'usernames', oldUsername));
                await setDoc(doc(db, 'usernames', newUsername), { uid: currentUser.uid });
                await updateDoc(doc(db, 'users', currentUser.uid), { username: newUsername });

                userProfile.username = newUsername;
                document.getElementById('settings-username-display').textContent = newUsername;
                document.getElementById('overview-username').textContent = newUsername;
                const url = `${window.location.origin}/${newUsername}`;
                document.getElementById('overview-profile-url').href = url;
                document.getElementById('overview-profile-url').textContent = url;

                document.getElementById('username-status').innerHTML = '<span class="status-success">✓ Changed!</span>';
                setTimeout(cancelEditUsername, 1500);
            } catch (e) {
                document.getElementById('username-status').innerHTML = '<span class="status-error">Error</span>';
            }
        };

        window.startEditDisplayName = function() {
            document.getElementById('displayname-view-mode').classList.add('hidden');
            document.getElementById('displayname-edit-mode').classList.remove('hidden');
            document.getElementById('new-displayname').value = userProfile.displayName || userProfile.username;
        };

        window.cancelEditDisplayName = function() {
            document.getElementById('displayname-view-mode').classList.remove('hidden');
            document.getElementById('displayname-edit-mode').classList.add('hidden');
            document.getElementById('displayname-status').innerHTML = '';
        };

        window.saveDisplayName = async function() {
            const newDisplayName = document.getElementById('new-displayname').value.trim();

            if (!newDisplayName || newDisplayName.length < 1) {
                document.getElementById('displayname-status').innerHTML = '<span class="status-error">Cannot be empty</span>';
                return;
            }

            try {
                await updateDoc(doc(db, 'users', currentUser.uid), { displayName: newDisplayName });

                userProfile.displayName = newDisplayName;
                document.getElementById('settings-displayname-display').textContent = newDisplayName;
                updatePreview();

                document.getElementById('displayname-status').innerHTML = '<span class="status-success">✓ Changed!</span>';
                setTimeout(cancelEditDisplayName, 1500);
            } catch (e) {
                document.getElementById('displayname-status').innerHTML = '<span class="status-error">Error</span>';
            }
        };

        function showDiscordConnected() {
            const name = `${userProfile.discord.username}#${userProfile.discord.discriminator || '0'}`;
            document.getElementById('settings-discord').textContent = name;
            document.getElementById('settings-discord-btn').textContent = 'Disconnect';
            document.getElementById('settings-discord-btn').onclick = disconnectDiscord;
        }

        window.connectDiscord = function() {
            const clientId = '1447016560559390923';
            const redirectUri = 'https://fakezone.github.io/discord-callback';
            window.location.href = `https://discord.com/api/oauth2/authorize?client_id=${clientId}&redirect_uri=${encodeURIComponent(redirectUri)}&response_type=code&scope=identify`;
        };

        window.disconnectDiscord = async function() {
            try {
                await updateDoc(doc(db, 'users', currentUser.uid), { discord: null });
                document.getElementById('settings-discord').textContent = 'Not connected';
                document.getElementById('settings-discord-btn').textContent = 'Connect';
                document.getElementById('settings-discord-btn').onclick = connectDiscord;
                userProfile.discord = null;
            } catch (e) {}
        };

        window.viewProfile = function() {
            if (userProfile) window.open(`/${userProfile.username}`, '_blank');
        };

        window.logout = async function() {
            stopAllAudio();
            await signOut(auth);
            window.location.href = '/';
        };

        window.addEventListener('beforeunload', function() {
            stopAllAudio();
        });
    </script>
</body>
</html>
