<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FakeZone - Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: #0a0a0a;
            font-family: 'Segoe UI', sans-serif;
            color: #fff;
            display: flex;
        }

        .sidebar {
            width: 250px;
            background: #000;
            border-right: 1px solid #1a1a1a;
            padding: 20px;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 40px;
            background: linear-gradient(45deg, #fff, #ff3333);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
            padding: 10px 0;
        }

        .menu-section {
            margin-bottom: 10px;
        }

        .menu-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 15px;
            background: #111;
            border: 1px solid #222;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .menu-header:hover {
            border-color: #ff3333;
            background: #151515;
        }

        .menu-header.active {
            border-color: #ff3333;
            background: rgba(255,51,51,0.05);
        }

        .menu-title {
            font-size: 14px;
            font-weight: 600;
            color: #fff;
        }

        .menu-arrow {
            transition: transform 0.3s;
            color: #666;
            font-size: 12px;
        }

        .menu-header.active .menu-arrow {
            transform: rotate(180deg);
            color: #ff3333;
        }

        .menu-dropdown {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .menu-dropdown.active {
            max-height: 200px;
        }

        .menu-link {
            display: block;
            padding: 12px 15px 12px 45px;
            color: #888;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.3s;
            border-left: 2px solid transparent;
            margin-left: 15px;
        }

        .menu-link:hover {
            color: #fff;
            background: rgba(255,255,255,0.02);
        }

        .menu-link.active {
            color: #ff3333;
            border-left-color: #ff3333;
            background: rgba(255,51,51,0.05);
        }

        .main-content {
            margin-left: 250px;
            flex: 1;
            padding: 30px;
            min-height: 100vh;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #1a1a1a;
        }

        .page-title {
            font-size: 24px;
            color: #fff;
        }

        .page-subtitle {
            color: #666;
            font-size: 14px;
            margin-top: 5px;
        }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 10px 20px;
            background: #1a1a1a;
            border: 1px solid #333;
            color: #fff;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .btn:hover {
            border-color: #ff3333;
            background: rgba(255,51,51,0.05);
        }

        .btn-primary {
            background: linear-gradient(135deg, #ff3333, #cc0000);
            border: none;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(255,51,51,0.4);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 13px;
        }

        .logout-btn {
            border-color: #ff3333;
            color: #ff3333;
        }

        .page-view {
            display: none;
        }

        .page-view.active {
            display: block;
        }

        .section-title {
            font-size: 14px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
            margin-top: 30px;
        }

        .section-title:first-child {
            margin-top: 0;
        }

        .tile-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .tile-grid-2 {
            grid-template-columns: repeat(2, 1fr);
        }

        .tile {
            background: #111;
            border: 1px solid #1a1a1a;
            border-radius: 10px;
            overflow: hidden;
        }

        .tile-header {
            background: #0a0a0a;
            padding: 12px 15px;
            border-bottom: 1px solid #1a1a1a;
            font-size: 13px;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .tile-content {
            padding: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group:last-child {
            margin-bottom: 0;
        }

        .form-group label {
            display: block;
            font-size: 11px;
            color: #666;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            background: #0a0a0a;
            border: 1px solid #222;
            border-radius: 6px;
            color: #fff;
            font-size: 14px;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #ff3333;
        }

        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .form-group select {
            cursor: pointer;
        }

        .form-group select option {
            background: #0a0a0a;
            color: #fff;
        }

        .toggle-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #1a1a1a;
        }

        .toggle-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .toggle-item:first-child {
            padding-top: 0;
        }

        .toggle-label {
            font-size: 13px;
            color: #fff;
        }

        .toggle-switch {
            position: relative;
            width: 44px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #222;
            border-radius: 24px;
            transition: 0.3s;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: #666;
            border-radius: 50%;
            transition: 0.3s;
        }

        .toggle-switch input:checked + .toggle-slider {
            background-color: rgba(255,51,51,0.3);
        }

        .toggle-switch input:checked + .toggle-slider:before {
            transform: translateX(20px);
            background-color: #ff3333;
        }

        .color-picker-wrapper {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .color-picker {
            width: 45px;
            height: 45px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            background: transparent;
            padding: 0;
        }

        .color-picker::-webkit-color-swatch-wrapper {
            padding: 0;
        }

        .color-picker::-webkit-color-swatch {
            border-radius: 6px;
            border: 2px solid #333;
        }

        .color-hex {
            flex: 1;
            font-family: monospace;
        }

        .range-wrapper {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .range-slider {
            flex: 1;
            -webkit-appearance: none;
            height: 6px;
            background: #222;
            border-radius: 3px;
            outline: none;
        }

        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: #ff3333;
            border-radius: 50%;
            cursor: pointer;
        }

        .range-value {
            min-width: 45px;
            text-align: center;
            font-size: 13px;
            color: #fff;
            background: #1a1a1a;
            padding: 5px 10px;
            border-radius: 4px;
        }

        .effect-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .effect-option {
            padding: 12px 8px;
            background: #0a0a0a;
            border: 2px solid #222;
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .effect-option:hover {
            border-color: #444;
        }

        .effect-option.active {
            border-color: #ff3333;
            background: rgba(255,51,51,0.05);
        }

        .effect-name {
            font-size: 11px;
            color: #888;
            margin-top: 5px;
        }

        .effect-preview {
            font-size: 16px;
            font-weight: bold;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .effect-none { color: #fff; }
        
        .effect-glitch {
            color: #fff;
            animation: glitchPreview 0.5s infinite;
        }
        
        @keyframes glitchPreview {
            0%, 100% { text-shadow: 2px 0 #ff0000, -2px 0 #00ffff; }
            50% { text-shadow: -2px 0 #ff0000, 2px 0 #00ffff; }
        }
        
        .effect-rainbow {
            background: linear-gradient(90deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #8b00ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-size: 200% 100%;
            animation: rainbowShift 2s linear infinite;
        }
        
        @keyframes rainbowShift {
            0% { background-position: 0% 50%; }
            100% { background-position: 200% 50%; }
        }
        
        .effect-glow {
            color: #fff;
            text-shadow: 0 0 10px #ff3333, 0 0 20px #ff3333;
        }
        
        .effect-wave {
            color: #fff;
            animation: wavePreview 1s ease-in-out infinite;
        }
        
        @keyframes wavePreview {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }

        .effect-typing {
            color: #fff;
            border-right: 2px solid #fff;
            animation: typingCursor 0.7s step-end infinite;
        }

        @keyframes typingCursor {
            50% { border-color: transparent; }
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }

        .info-card {
            background: #111;
            border: 1px solid #1a1a1a;
            border-radius: 10px;
            padding: 20px;
        }

        .info-card-label {
            font-size: 11px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }

        .info-card-value {
            font-size: 16px;
            color: #fff;
            font-weight: 500;
            word-break: break-all;
        }

        .info-card-value a {
            color: #ff3333;
            text-decoration: none;
        }

        .settings-section {
            background: #111;
            border: 1px solid #1a1a1a;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .settings-section h3 {
            font-size: 14px;
            color: #fff;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #222;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .setting-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid #1a1a1a;
        }

        .setting-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .setting-info {
            flex: 1;
        }

        .setting-label {
            font-size: 14px;
            color: #fff;
            margin-bottom: 4px;
        }

        .setting-value {
            font-size: 13px;
            color: #666;
        }

        .setting-action {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .edit-input {
            padding: 8px 12px;
            background: #0a0a0a;
            border: 1px solid #333;
            border-radius: 4px;
            color: #fff;
            font-size: 13px;
            width: 180px;
        }

        .edit-input:focus {
            outline: none;
            border-color: #ff3333;
        }

        .edit-buttons {
            display: flex;
            gap: 8px;
        }

        .btn-save {
            padding: 6px 12px;
            background: #ff3333;
            border: none;
            color: #fff;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .btn-cancel {
            padding: 6px 12px;
            background: transparent;
            border: 1px solid #666;
            color: #666;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        /* Preview Box with Background */
        .preview-wrapper {
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .preview-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            z-index: 0;
        }

        .preview-bg-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1;
        }

        .preview-box {
            background: #111;
            border: 1px solid #1a1a1a;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            position: relative;
            z-index: 2;
        }

        .preview-box.has-bg {
            background: transparent;
            border: none;
        }

        .preview-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            border: 3px solid #ff3333;
            margin-bottom: 15px;
            object-fit: cover;
        }

        .preview-name {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .preview-bio {
            color: #888;
            font-size: 14px;
            max-width: 400px;
            margin: 0 auto;
        }

        .status-success {
            color: #00ff00;
            font-size: 13px;
            margin-top: 5px;
        }

        .status-error {
            color: #ff3333;
            font-size: 13px;
            margin-top: 5px;
        }

        .hidden {
            display: none !important;
        }

        .save-section {
            margin-top: 20px;
        }

        /* Audio Controls */
        .audio-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }

        .btn-audio {
            padding: 8px 16px;
            background: #1a1a1a;
            border: 1px solid #333;
            color: #fff;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s;
        }

        .btn-audio:hover {
            border-color: #ff3333;
        }

        .btn-audio.playing {
            background: rgba(255,51,51,0.2);
            border-color: #ff3333;
        }

        .audio-status {
            font-size: 11px;
            color: #666;
        }

        .audio-status.playing {
            color: #00ff00;
        }

        .audio-info {
            font-size: 11px;
            color: #666;
            margin-top: 8px;
        }

        @media (max-width: 1200px) {
            .tile-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .info-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 900px) {
            .tile-grid {
                grid-template-columns: 1fr;
            }
            .effect-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 220px;
            }
            .main-content {
                margin-left: 220px;
            }
            .info-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Poppins:wght@400;600&family=Montserrat:wght@400;600&family=Open+Sans:wght@400;600&family=Lato:wght@400;700&family=Oswald:wght@400;600&family=Playfair+Display:wght@400;700&family=Ubuntu:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="logo">FakeZone</div>
        
        <div class="menu-section">
            <div class="menu-header active" onclick="toggleMenu('account')">
                <span class="menu-title">Account</span>
                <span class="menu-arrow">▼</span>
            </div>
            <div class="menu-dropdown active" id="account-dropdown">
                <a href="#" class="menu-link active" onclick="showPage('overview', this)">Overview</a>
                <a href="#" class="menu-link" onclick="showPage('settings', this)">Settings</a>
            </div>
        </div>

        <div class="menu-section">
            <div class="menu-header" onclick="toggleMenu('profile')">
                <span class="menu-title">Profile</span>
                <span class="menu-arrow">▼</span>
            </div>
            <div class="menu-dropdown" id="profile-dropdown">
                <a href="#" class="menu-link" onclick="showPage('customize', this)">Customize</a>
                <a href="#" class="menu-link" onclick="viewProfile()">View Profile</a>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        
        <!-- OVERVIEW PAGE -->
        <div class="page-view active" id="page-overview">
            <div class="page-header">
                <div>
                    <h1 class="page-title">Overview</h1>
                    <p class="page-subtitle">Welcome to FakeZone dashboard</p>
                </div>
                <div class="header-actions">
                    <button class="btn logout-btn" onclick="logout()">Logout</button>
                </div>
            </div>

            <div class="info-grid">
                <div class="info-card">
                    <div class="info-card-label">Username</div>
                    <div class="info-card-value" id="overview-username">-</div>
                </div>
                <div class="info-card">
                    <div class="info-card-label">Email</div>
                    <div class="info-card-value" id="overview-email">-</div>
                </div>
                <div class="info-card">
                    <div class="info-card-label">Profile</div>
                    <div class="info-card-value">
                        <a href="#" id="overview-profile-url" target="_blank">-</a>
                    </div>
                </div>
                <div class="info-card">
                    <div class="info-card-label">UID</div>
                    <div class="info-card-value" id="overview-uid">-</div>
                </div>
            </div>
        </div>

        <!-- SETTINGS PAGE -->
        <div class="page-view" id="page-settings">
            <div class="page-header">
                <div>
                    <h1 class="page-title">Settings</h1>
                    <p class="page-subtitle">Manage your account</p>
                </div>
                <div class="header-actions">
                    <button class="btn logout-btn" onclick="logout()">Logout</button>
                </div>
            </div>

            <div class="settings-section">
                <h3>Account Information</h3>
                
                <!-- Username -->
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Username</div>
                        <div class="setting-value" id="settings-username-display">-</div>
                        <div id="username-status"></div>
                    </div>
                    <div class="setting-action" id="username-view-mode">
                        <button class="btn btn-small" onclick="startEditUsername()">Change</button>
                    </div>
                    <div class="setting-action hidden" id="username-edit-mode">
                        <input type="text" class="edit-input" id="new-username">
                        <div class="edit-buttons">
                            <button class="btn-save" onclick="saveUsername()">Save</button>
                            <button class="btn-cancel" onclick="cancelEditUsername()">Cancel</button>
                        </div>
                    </div>
                </div>

                <!-- Display Name -->
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Display Name</div>
                        <div class="setting-value" id="settings-displayname-display">-</div>
                        <div id="displayname-status"></div>
                    </div>
                    <div class="setting-action" id="displayname-view-mode">
                        <button class="btn btn-small" onclick="startEditDisplayName()">Change</button>
                    </div>
                    <div class="setting-action hidden" id="displayname-edit-mode">
                        <input type="text" class="edit-input" id="new-displayname">
                        <div class="edit-buttons">
                            <button class="btn-save" onclick="saveDisplayName()">Save</button>
                            <button class="btn-cancel" onclick="cancelEditDisplayName()">Cancel</button>
                        </div>
                    </div>
                </div>

                <!-- Email -->
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Email</div>
                        <div class="setting-value" id="settings-email">-</div>
                    </div>
                    <div class="setting-action">
                        <button class="btn btn-small" onclick="alert('Coming soon')">Change</button>
                    </div>
                </div>

                <!-- Password -->
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Password</div>
                        <div class="setting-value">••••••••</div>
                    </div>
                    <div class="setting-action">
                        <button class="btn btn-small" onclick="alert('Coming soon')">Change</button>
                    </div>
                </div>
            </div>

            <div class="settings-section">
                <h3>Connected Accounts</h3>
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Discord</div>
                        <div class="setting-value" id="settings-discord">Not connected</div>
                    </div>
                    <div class="setting-action">
                        <button class="btn btn-small" id="settings-discord-btn" onclick="connectDiscord()">Connect</button>
                    </div>
                </div>
            </div>

            <div class="settings-section" style="border-color: #ff3333;">
                <h3 style="color: #ff3333;">Danger Zone</h3>
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">Delete Account</div>
                        <div class="setting-value">Permanently delete your account and data</div>
                    </div>
                    <div class="setting-action">
                        <button class="btn btn-small" style="border-color:#ff3333; color:#ff3333;">Delete</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- CUSTOMIZE PAGE -->
        <div class="page-view" id="page-customize">
            <div class="page-header">
                <div>
                    <h1 class="page-title">Customize</h1>
                    <p class="page-subtitle">Customize your profile appearance</p>
                </div>
                <div class="header-actions">
                    <button class="btn" onclick="viewProfile()">View Profile</button>
                    <button class="btn logout-btn" onclick="logout()">Logout</button>
                </div>
            </div>

            <!-- Assets Uploader -->
            <div class="section-title">Assets Uploader</div>
            <div class="tile-grid">
                <div class="tile">
                    <div class="tile-header">Background</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Background Image URL</label>
                            <input type="url" id="bg-image" placeholder="https://example.com/bg.jpg" oninput="updatePreview()">
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">Audio</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Music URL</label>
                            <input type="url" id="bg-audio" placeholder="YouTube or MP3 URL" oninput="validateAudioURL(this.value)">
                            <div class="audio-info">Supports: YouTube, MP3, WAV, OGG</div>
                        </div>
                        <div class="form-group">
                            <label>Volume</label>
                            <div class="range-wrapper">
                                <input type="range" class="range-slider" id="audio-volume" min="0" max="100" value="50" oninput="updateVolumeLabel()">
                                <span class="range-value" id="audio-volume-label">50%</span>
                            </div>
                        </div>
                        <div class="audio-controls">
                            <button class="btn-audio" id="audio-test-btn" onclick="toggleTestAudio()">
                                <span id="audio-test-text">▶ Test Audio</span>
                            </button>
                            <span class="audio-status" id="audio-status"></span>
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">Profile Avatar</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Avatar URL</label>
                            <input type="url" id="avatar" placeholder="https://example.com/avatar.png" oninput="updatePreview()">
                        </div>
                        <p style="font-size:11px; color:#666; margin-top:10px;">Empty = Discord avatar</p>
                    </div>
                </div>
            </div>

            <!-- General Customization -->
            <div class="section-title">General Customization</div>
            <div class="tile-grid tile-grid-2">
                <div class="tile">
                    <div class="tile-header">Bio</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Content</label>
                            <textarea id="bio" placeholder="Write something about yourself..." oninput="updatePreview()"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Font</label>
                            <select id="bio-font" onchange="updatePreview()">
                                <option value="Segoe UI">Segoe UI</option>
                                <option value="Roboto">Roboto</option>
                                <option value="Poppins">Poppins</option>
                                <option value="Montserrat">Montserrat</option>
                                <option value="Open Sans">Open Sans</option>
                                <option value="Lato">Lato</option>
                                <option value="Oswald">Oswald</option>
                                <option value="Playfair Display">Playfair Display</option>
                                <option value="Ubuntu">Ubuntu</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Color</label>
                            <div class="color-picker-wrapper">
                                <input type="color" class="color-picker" id="bio-color" value="#888888" oninput="updateBioColorHex(); updatePreview();">
                                <input type="text" class="edit-input color-hex" id="bio-color-hex" value="#888888" oninput="updateBioColorPicker(); updatePreview();">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">Username</div>
                    <div class="tile-content">
                        <div class="form-group">
                            <label>Effect</label>
                            <div class="effect-grid">
                                <div class="effect-option active" data-effect="none" onclick="selectEffect('none')">
                                    <div class="effect-preview effect-none">Aa</div>
                                    <div class="effect-name">None</div>
                                </div>
                                <div class="effect-option" data-effect="glitch" onclick="selectEffect('glitch')">
                                    <div class="effect-preview effect-glitch">Aa</div>
                                    <div class="effect-name">Glitch</div>
                                </div>
                                <div class="effect-option" data-effect="rainbow" onclick="selectEffect('rainbow')">
                                    <div class="effect-preview effect-rainbow">Aa</div>
                                    <div class="effect-name">Rainbow</div>
                                </div>
                                <div class="effect-option" data-effect="glow" onclick="selectEffect('glow')">
                                    <div class="effect-preview effect-glow">Aa</div>
                                    <div class="effect-name">Glow</div>
                                </div>
                                <div class="effect-option" data-effect="wave" onclick="selectEffect('wave')">
                                    <div class="effect-preview effect-wave">Aa</div>
                                    <div class="effect-name">Wave</div>
                                </div>
                                <div class="effect-option" data-effect="typing" onclick="selectEffect('typing')">
                                    <div class="effect-preview effect-typing">Aa</div>
                                    <div class="effect-name">Typing</div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Color</label>
                            <div class="color-picker-wrapper">
                                <input type="color" class="color-picker" id="username-color" value="#ffffff" oninput="updateUsernameColorHex(); updatePreview();">
                                <input type="text" class="edit-input color-hex" id="username-color-hex" value="#ffffff" oninput="updateUsernameColorPicker(); updatePreview();">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Profile Effects -->
            <div class="section-title">Profile Effects</div>
            <div class="tile-grid tile-grid-2">
                <div class="tile">
                    <div class="tile-header">Profile Opacity</div>
                    <div class="tile-content">
                        <div class="range-wrapper">
                            <input type="range" class="range-slider" id="profile-opacity" min="0" max="100" value="100" oninput="updateOpacityLabel(); updatePreview();">
                            <span class="range-value" id="profile-opacity-label">100%</span>
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">Profile Blur</div>
                    <div class="tile-content">
                        <div class="range-wrapper">
                            <input type="range" class="range-slider" id="profile-blur" min="0" max="100" value="0" oninput="updateBlurLabel(); updatePreview();">
                            <span class="range-value" id="profile-blur-label">0%</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Other Customization -->
            <div class="section-title">Other Customization</div>
            <div class="tile-grid">
                <div class="tile">
                    <div class="tile-header">Discord Avatar</div>
                    <div class="tile-content">
                        <div class="toggle-item">
                            <span class="toggle-label">Use Discord avatar</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="toggle-discord-avatar" onchange="updatePreview()">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">Volume Control</div>
                    <div class="tile-content">
                        <div class="toggle-item">
                            <span class="toggle-label">Show volume control</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="toggle-volume-control" onchange="updatePreview()">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="tile">
                    <div class="tile-header">Avatar Decoration</div>
                    <div class="tile-content">
                        <div class="toggle-item">
                            <span class="toggle-label">Show Discord decoration</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="toggle-avatar-decoration" onchange="updatePreview()">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Preview -->
            <div class="section-title">Preview</div>
            <div class="preview-wrapper">
                <div class="preview-bg" id="preview-bg"></div>
                <div class="preview-bg-overlay" id="preview-bg-overlay" style="display:none;"></div>
                <div class="preview-box" id="preview-container">
                    <img id="previewAvatar" class="preview-avatar" src="https://via.placeholder.com/100">
                    <div id="previewUsername" class="preview-name">@username</div>
                    <div id="previewBio" class="preview-bio">Your bio here...</div>
                </div>
            </div>

            <!-- Save -->
            <div class="save-section">
                <button class="btn btn-primary" onclick="saveCustomization()" style="width:100%;">Save Changes</button>
                <div id="customizeSaveStatus"></div>
            </div>
        </div>
    </div>

    <!-- Hidden YouTube Player -->
    <div id="youtube-player" style="display:none;"></div>
    
    <!-- Hidden Audio Element -->
    <audio id="test-audio" style="display:none;"></audio>

    <!-- YouTube API -->
    <script src="https://www.youtube.com/iframe_api"></script>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, doc, getDoc, updateDoc, deleteDoc, setDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyBIjlu_2muS5ky7hTjsc5E9gV0uOwprX0o",
            authDomain: "fakezone-f3c4a.firebaseapp.com",
            projectId: "fakezone-f3c4a",
            storageBucket: "fakezone-f3c4a.firebasestorage.app",
            messagingSenderId: "795138686378",
            appId: "1:795138686378:web:5e93855a9bf8682f197fd3"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let currentUser = null;
        let userProfile = null;
        let selectedEffect = 'none';
        let youtubePlayer = null;
        let audioPlayer = null;
        let isPlaying = false;

        // Format UID
        function formatUid(num) {
            return '#' + String(num).padStart(4, '0');
        }

        // Toggle menu
        window.toggleMenu = function(menuId) {
            const dropdown = document.getElementById(menuId + '-dropdown');
            const header = dropdown.previousElementSibling;
            dropdown.classList.toggle('active');
            header.classList.toggle('active');
        };

        // Show page
        window.showPage = function(pageId, linkElement) {
            document.querySelectorAll('.page-view').forEach(p => p.classList.remove('active'));
            document.getElementById('page-' + pageId).classList.add('active');
            document.querySelectorAll('.menu-link').forEach(l => l.classList.remove('active'));
            if (linkElement) linkElement.classList.add('active');
        };

        // Mask email
        function maskEmail(email) {
            if (email.length <= 5) return email;
            return email.substring(0, 5) + '*'.repeat(email.length - 5);
        }

        // Extract YouTube Video ID
        function extractYouTubeId(url) {
            const regex = /(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/|youtube\.com\/v\/)([^&\n?#]+)/;
            const match = url.match(regex);
            return match ? match[1] : null;
        }

        // Validate Audio URL
        window.validateAudioURL = function(url) {
            if (!url) return true;
            
            const audioExtensions = ['.mp3', '.wav', '.ogg', '.m4a', '.webm'];
            const isDirectAudio = audioExtensions.some(ext => url.toLowerCase().includes(ext));
            const isYouTube = url.includes('youtube.com') || url.includes('youtu.be');
            
            const statusEl = document.getElementById('audio-status');
            
            if (isYouTube) {
                statusEl.textContent = 'YouTube detected ✓';
                statusEl.className = 'audio-status playing';
            } else if (isDirectAudio) {
                statusEl.textContent = 'Direct audio detected ✓';
                statusEl.className = 'audio-status playing';
            } else if (url) {
                statusEl.textContent = 'Unknown format - may not work';
                statusEl.className = 'audio-status';
            } else {
                statusEl.textContent = '';
            }
            
            return true;
        };

        // YouTube API Ready
        window.onYouTubeIframeAPIReady = function() {
            console.log('YouTube API ready');
        };

        // Toggle Test Audio
        window.toggleTestAudio = function() {
            const url = document.getElementById('bg-audio').value;
            const volume = document.getElementById('audio-volume').value;
            const btn = document.getElementById('audio-test-btn');
            const textEl = document.getElementById('audio-test-text');
            
            if (!url) {
                alert('Please enter an audio URL first');
                return;
            }
            
            if (isPlaying) {
                stopAllAudio();
                btn.classList.remove('playing');
                textEl.textContent = '▶ Test Audio';
                isPlaying = false;
            } else {
                playTestAudio(url, volume);
                btn.classList.add('playing');
                textEl.textContent = '⏸ Stop';
                isPlaying = true;
            }
        };

        // Stop all audio
        function stopAllAudio() {
            if (audioPlayer) {
                audioPlayer.pause();
                audioPlayer = null;
            }
            if (youtubePlayer) {
                youtubePlayer.destroy();
                youtubePlayer = null;
            }
        }

        // Play test audio
        function playTestAudio(url, volume) {
            stopAllAudio();
            
            const videoId = extractYouTubeId(url);
            
            if (videoId) {
                // YouTube
                youtubePlayer = new YT.Player('youtube-player', {
                    height: '0',
                    width: '0',
                    videoId: videoId,
                    playerVars: {
                        autoplay: 1,
                        loop: 1,
                        playlist: videoId
                    },
                    events: {
                        onReady: function(event) {
                            event.target.setVolume(volume);
                            event.target.playVideo();
                        },
                        onError: function(error) {
                            alert('Error loading YouTube video. Check the URL.');
                            toggleTestAudio();
                        }
                    }
                });
            } else {
                // Direct audio file
                audioPlayer = document.getElementById('test-audio');
                audioPlayer.src = url;
                audioPlayer.volume = volume / 100;
                audioPlayer.loop = true;
                audioPlayer.play().catch(e => {
                    alert('Error playing audio. Check the URL or try a different format.');
                    toggleTestAudio();
                });
            }
        }

        // Auth check
        onAuthStateChanged(auth, async (user) => {
            if (!user) {
                window.location.href = '/';
                return;
            }
            currentUser = user;
            await loadProfile();
        });

        // Load profile
        async function loadProfile() {
            const docSnap = await getDoc(doc(db, 'users', currentUser.uid));
            if (docSnap.exists()) {
                userProfile = docSnap.data();
                const profileUrl = `${window.location.origin}/${userProfile.username}`;
                const maskedEmail = maskEmail(currentUser.email);

                // Overview
                document.getElementById('overview-username').textContent = userProfile.username;
                document.getElementById('overview-email').textContent = maskedEmail;
                document.getElementById('overview-profile-url').href = profileUrl;
                document.getElementById('overview-profile-url').textContent = profileUrl;
                document.getElementById('overview-uid').textContent = formatUid(userProfile.uidNumber || 1);

                // Settings
                document.getElementById('settings-username-display').textContent = userProfile.username;
                document.getElementById('settings-displayname-display').textContent = userProfile.displayName || userProfile.username;
                document.getElementById('settings-email').textContent = maskedEmail;

                // Customize
                document.getElementById('avatar').value = userProfile.avatar || '';
                document.getElementById('bio').value = userProfile.bio || '';
                document.getElementById('bg-image').value = userProfile.bgImage || '';
                document.getElementById('bg-audio').value = userProfile.bgAudio || '';
                document.getElementById('audio-volume').value = userProfile.audioVolume || 50;
                document.getElementById('bio-font').value = userProfile.bioFont || 'Segoe UI';
                document.getElementById('bio-color').value = userProfile.bioColor || '#888888';
                document.getElementById('bio-color-hex').value = userProfile.bioColor || '#888888';
                document.getElementById('username-color').value = userProfile.usernameColor || '#ffffff';
                document.getElementById('username-color-hex').value = userProfile.usernameColor || '#ffffff';
                document.getElementById('profile-opacity').value = userProfile.profileOpacity ?? 100;
                document.getElementById('profile-blur').value = userProfile.profileBlur || 0;

                // Toggles
                document.getElementById('toggle-discord-avatar').checked = userProfile.useDiscordAvatar || false;
                document.getElementById('toggle-volume-control').checked = userProfile.showVolumeControl || false;
                document.getElementById('toggle-avatar-decoration').checked = userProfile.showAvatarDecoration || false;

                // Effect
                if (userProfile.usernameEffect) {
                    selectedEffect = userProfile.usernameEffect;
                    document.querySelectorAll('.effect-option').forEach(opt => {
                        opt.classList.toggle('active', opt.dataset.effect === selectedEffect);
                    });
                }

                // Discord
                if (userProfile.discord) {
                    showDiscordConnected();
                }

                // Update labels
                updateVolumeLabel();
                updateOpacityLabel();
                updateBlurLabel();
                updatePreview();
            }
        }

        // Update preview
        window.updatePreview = function() {
            const useDiscordAvatar = document.getElementById('toggle-discord-avatar').checked;
            const customAvatar = document.getElementById('avatar').value;
            const bgImage = document.getElementById('bg-image').value;
            
            // Background
            const previewBg = document.getElementById('preview-bg');
            const previewBgOverlay = document.getElementById('preview-bg-overlay');
            const previewContainer = document.getElementById('preview-container');
            
            if (bgImage) {
                previewBg.style.backgroundImage = `url('${bgImage}')`;
                previewBgOverlay.style.display = 'block';
                previewContainer.classList.add('has-bg');
            } else {
                previewBg.style.backgroundImage = '';
                previewBgOverlay.style.display = 'none';
                previewContainer.classList.remove('has-bg');
            }
            
            // Avatar
            let avatar = 'https://via.placeholder.com/100';
            if (useDiscordAvatar && userProfile?.discord?.avatar) {
                avatar = userProfile.discord.avatar;
            } else if (customAvatar) {
                avatar = customAvatar;
            } else if (userProfile?.discord?.avatar) {
                avatar = userProfile.discord.avatar;
            }

            const bio = document.getElementById('bio').value || 'Your bio here...';
            const displayName = userProfile?.displayName || userProfile?.username || 'username';
            const bioFont = document.getElementById('bio-font').value;
            const bioColor = document.getElementById('bio-color').value;
            const usernameColor = document.getElementById('username-color').value;
            const opacity = document.getElementById('profile-opacity').value;
            const blur = document.getElementById('profile-blur').value;

            document.getElementById('previewAvatar').src = avatar;

            const usernameEl = document.getElementById('previewUsername');
            usernameEl.textContent = '@' + displayName;
            usernameEl.className = 'preview-name';
            usernameEl.style.color = usernameColor;
            if (selectedEffect !== 'none') {
                usernameEl.classList.add('effect-' + selectedEffect);
            }

            const bioEl = document.getElementById('previewBio');
            bioEl.textContent = bio;
            bioEl.style.color = bioColor;
            bioEl.style.fontFamily = `'${bioFont}', sans-serif`;

            previewContainer.style.opacity = opacity / 100;
            previewContainer.style.filter = `blur(${blur / 10}px)`;
        };

        // Effect selection
        window.selectEffect = function(effect) {
            selectedEffect = effect;
            document.querySelectorAll('.effect-option').forEach(opt => {
                opt.classList.toggle('active', opt.dataset.effect === effect);
            });
            updatePreview();
        };

        // Color syncs
        window.updateBioColorHex = function() {
            document.getElementById('bio-color-hex').value = document.getElementById('bio-color').value;
        };
        window.updateBioColorPicker = function() {
            const hex = document.getElementById('bio-color-hex').value;
            if (/^#[0-9A-Fa-f]{6}$/.test(hex)) {
                document.getElementById('bio-color').value = hex;
            }
        };
        window.updateUsernameColorHex = function() {
            document.getElementById('username-color-hex').value = document.getElementById('username-color').value;
        };
        window.updateUsernameColorPicker = function() {
            const hex = document.getElementById('username-color-hex').value;
            if (/^#[0-9A-Fa-f]{6}$/.test(hex)) {
                document.getElementById('username-color').value = hex;
            }
        };

        // Range labels
        window.updateVolumeLabel = function() {
            document.getElementById('audio-volume-label').textContent = document.getElementById('audio-volume').value + '%';
            
            // Update volume if audio is playing
            if (audioPlayer && !audioPlayer.paused) {
                audioPlayer.volume = document.getElementById('audio-volume').value / 100;
            }
            if (youtubePlayer && youtubePlayer.setVolume) {
                youtubePlayer.setVolume(document.getElementById('audio-volume').value);
            }
        };
        window.updateOpacityLabel = function() {
            document.getElementById('profile-opacity-label').textContent = document.getElementById('profile-opacity').value + '%';
        };
        window.updateBlurLabel = function() {
            document.getElementById('profile-blur-label').textContent = document.getElementById('profile-blur').value + '%';
        };

        // Save customization
        window.saveCustomization = async function() {
            try {
                stopAllAudio(); // Stop audio before saving
                
                await updateDoc(doc(db, 'users', currentUser.uid), {
                    avatar: document.getElementById('avatar').value,
                    bio: document.getElementById('bio').value,
                    bgImage: document.getElementById('bg-image').value,
                    bgAudio: document.getElementById('bg-audio').value,
                    audioVolume: parseInt(document.getElementById('audio-volume').value),
                    bioFont: document.getElementById('bio-font').value,
                    bioColor: document.getElementById('bio-color').value,
                    usernameColor: document.getElementById('username-color').value,
                    usernameEffect: selectedEffect,
                    profileOpacity: parseInt(document.getElementById('profile-opacity').value),
                    profileBlur: parseInt(document.getElementById('profile-blur').value),
                    useDiscordAvatar: document.getElementById('toggle-discord-avatar').checked,
                    showVolumeControl: document.getElementById('toggle-volume-control').checked,
                    showAvatarDecoration: document.getElementById('toggle-avatar-decoration').checked
                });
                
                document.getElementById('customizeSaveStatus').innerHTML = '<div class="status-success">✓ Saved! Your profile has been updated.</div>';
                setTimeout(() => document.getElementById('customizeSaveStatus').innerHTML = '', 3000);
                
                // Reset audio button
                const btn = document.getElementById('audio-test-btn');
                const textEl = document.getElementById('audio-test-text');
                btn.classList.remove('playing');
                textEl.textContent = '▶ Test Audio';
                isPlaying = false;
                
            } catch (error) {
                console.error('Error saving:', error);
                document.getElementById('customizeSaveStatus').innerHTML = '<div class="status-error">Error saving changes</div>';
            }
        };

        // Username editing
        window.startEditUsername = function() {
            document.getElementById('username-view-mode').classList.add('hidden');
            document.getElementById('username-edit-mode').classList.remove('hidden');
            document.getElementById('new-username').value = userProfile.username;
        };

        window.cancelEditUsername = function() {
            document.getElementById('username-view-mode').classList.remove('hidden');
            document.getElementById('username-edit-mode').classList.add('hidden');
            document.getElementById('username-status').innerHTML = '';
        };

        window.saveUsername = async function() {
            const newUsername = document.getElementById('new-username').value.toLowerCase().trim();
            const oldUsername = userProfile.username;

            if (!newUsername || newUsername.length < 3) {
                document.getElementById('username-status').innerHTML = '<span class="status-error">Min. 3 characters</span>';
                return;
            }
            if (!/^[a-z0-9_]+$/.test(newUsername)) {
                document.getElementById('username-status').innerHTML = '<span class="status-error">Only a-z, 0-9, _</span>';
                return;
            }
            if (newUsername === oldUsername) {
                cancelEditUsername();
                return;
            }

            try {
                const exists = await getDoc(doc(db, 'usernames', newUsername));
                if (exists.exists()) {
                    document.getElementById('username-status').innerHTML = '<span class="status-error">Already taken</span>';
                    return;
                }

                await deleteDoc(doc(db, 'usernames', oldUsername));
                await setDoc(doc(db, 'usernames', newUsername), { uid: currentUser.uid });
                await updateDoc(doc(db, 'users', currentUser.uid), { username: newUsername });

                userProfile.username = newUsername;
                document.getElementById('settings-username-display').textContent = newUsername;
                document.getElementById('overview-username').textContent = newUsername;
                const url = `${window.location.origin}/${newUsername}`;
                document.getElementById('overview-profile-url').href = url;
                document.getElementById('overview-profile-url').textContent = url;

                document.getElementById('username-status').innerHTML = '<span class="status-success">✓ Changed!</span>';
                setTimeout(cancelEditUsername, 1500);
            } catch (e) {
                document.getElementById('username-status').innerHTML = '<span class="status-error">Error</span>';
            }
        };

        // Display Name editing
        window.startEditDisplayName = function() {
            document.getElementById('displayname-view-mode').classList.add('hidden');
            document.getElementById('displayname-edit-mode').classList.remove('hidden');
            document.getElementById('new-displayname').value = userProfile.displayName || userProfile.username;
        };

        window.cancelEditDisplayName = function() {
            document.getElementById('displayname-view-mode').classList.remove('hidden');
            document.getElementById('displayname-edit-mode').classList.add('hidden');
            document.getElementById('displayname-status').innerHTML = '';
        };

        window.saveDisplayName = async function() {
            const newDisplayName = document.getElementById('new-displayname').value.trim();

            if (!newDisplayName || newDisplayName.length < 1) {
                document.getElementById('displayname-status').innerHTML = '<span class="status-error">Cannot be empty</span>';
                return;
            }

            try {
                await updateDoc(doc(db, 'users', currentUser.uid), { displayName: newDisplayName });

                userProfile.displayName = newDisplayName;
                document.getElementById('settings-displayname-display').textContent = newDisplayName;
                updatePreview();

                document.getElementById('displayname-status').innerHTML = '<span class="status-success">✓ Changed!</span>';
                setTimeout(cancelEditDisplayName, 1500);
            } catch (e) {
                document.getElementById('displayname-status').innerHTML = '<span class="status-error">Error</span>';
            }
        };

        // Discord
        function showDiscordConnected() {
            const name = `${userProfile.discord.username}#${userProfile.discord.discriminator || '0'}`;
            document.getElementById('settings-discord').textContent = name;
            document.getElementById('settings-discord-btn').textContent = 'Disconnect';
            document.getElementById('settings-discord-btn').onclick = disconnectDiscord;
        }

        window.connectDiscord = function() {
            const clientId = '1447016560559390923';
            const redirectUri = 'https://fakezone.github.io/discord-callback';
            window.location.href = `https://discord.com/api/oauth2/authorize?client_id=${clientId}&redirect_uri=${encodeURIComponent(redirectUri)}&response_type=code&scope=identify`;
        };

        window.disconnectDiscord = async function() {
            try {
                await updateDoc(doc(db, 'users', currentUser.uid), { discord: null });
                document.getElementById('settings-discord').textContent = 'Not connected';
                document.getElementById('settings-discord-btn').textContent = 'Connect';
                document.getElementById('settings-discord-btn').onclick = connectDiscord;
                userProfile.discord = null;
            } catch (e) {}
        };

        window.viewProfile = function() {
            if (userProfile) window.open(`/${userProfile.username}`, '_blank');
        };

        window.logout = async function() {
            stopAllAudio();
            await signOut(auth);
            window.location.href = '/';
        };

        // Clean up audio on page unload
        window.addEventListener('beforeunload', function() {
            stopAllAudio();
        });
    </script>
</body>
</html>
